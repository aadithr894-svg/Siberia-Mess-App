{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <div class="card shadow-lg border-0 rounded-4">
    <div class="card-header bg-primary text-white text-center rounded-top-4">
      <h3 class="mb-0">🍽️ Mess Skip Request</h3>
    </div>
    <div class="card-body p-4">
      <form method="POST">
        
        <!-- Date Picker -->
        <div class="mb-4">
          <label for="skip_date" class="form-label fw-bold">📅 Select Date:</label>
          <input type="date" 
                 name="skip_date" 
                 id="skip_date"
                 required 
                 class="form-control form-control-lg rounded-3 shadow-sm"
                 onkeydown="return false;">
        </div>

        <!-- Meal Checkboxes -->
        <div class="mb-4">
          <label class="form-label fw-bold">🥗 Meals to Skip:</label>
          <div class="d-flex flex-wrap gap-4 mt-2">

            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" name="breakfast" id="breakfast">
              <label class="form-check-label" for="breakfast">🍳 Breakfast</label>
            </div>

            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" name="lunch" id="lunch">
              <label class="form-check-label" for="lunch">🍛 Lunch</label>
            </div>

            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" name="dinner" id="dinner">
              <label class="form-check-label" for="dinner">🍲 Dinner</label>
            </div>

          </div>
        </div>

        <!-- Submit -->
        <div class="text-center">
          <button type="submit" class="btn btn-lg btn-success px-5 shadow-sm">
            ✅ Save Skip
          </button>
        </div>

      </form>
    </div>
  </div>
</div>

<!-- Script to enforce skip date rules -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const dateInput = document.getElementById("skip_date");
    const now = new Date();

    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);

    const dayAfterTomorrow = new Date();
    dayAfterTomorrow.setDate(dayAfterTomorrow.getDate() + 2);

    let minDate;

    if (now.getHours() < 22) {
      // Before 10 PM → tomorrow and beyond
      minDate = tomorrow.toISOString().split("T")[0];
    } else {
      // After 10 PM → day after tomorrow and beyond
      minDate = dayAfterTomorrow.toISOString().split("T")[0];
    }

    dateInput.setAttribute("min", minDate);

    // Prevent typing
    dateInput.addEventListener("keydown", function(e) {
      e.preventDefault();
    });
  });
</script>
{% endblock %}
